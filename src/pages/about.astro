---
import Layout from '@/layouts/Base.astro';
import { getCollection } from 'astro:content';
import { Picture } from 'astro:assets';
import ProfileCard from '@/components/Profile/ProfileCard.astro';
import SIGPwnyMorphology from '@/components/SIGPwnyMorphology';

import pie_chart from '@/assets/meeting-format-chart.png';

async function filterByRole(role: string) {
  return (await getCollection('profiles', ({ data }) => (
    data.role === role
  ))).map(
    (x) => x.data
  ).sort(
    (a, b) => b.weight - a.weight
  );
}

const admins = await filterByRole('admin');
const helpers = await filterByRole('helper');
const alumni = (await filterByRole('alum')).sort(
  // Sort by period (if available)
  (a, b) => {
    if (a.period && b.period) {
      return a.period.localeCompare(b.period);
    } else if (a.period) {
      return -1;
    } else if (b.period) {
      return 1;
    } else {
      return 0;
    }
  }
);
---

<Layout
  title="About"
  description="Learn about who SIGPwny is and our mission"
>
  <div class="flex flex-col justify-between">
    <div class="flex flex-col gap-8">
      <section id="acronym" class="py-8">
        <div class="flex flex-col">
          <SIGPwnyMorphology client:load />
          <div class="flex flex-row justify-center">
            <p>sig-<b>poh</b>-nee</p>
          </div>
        </div>
      </section>
      <section id="what-we-do">
        <div class="text-center">
          <div class="panel mx-auto max-w-prose">
            <p class="font-bold text-4xl">
              What do we do?
            </p>
            <p class="m-0">
              As the cybersecurity club at the University of Illinois Urbana-Champaign, our mission is to 
              teach students cybersecurity through meetings, competitions, and research.
            </p>
          </div>
        </div>
      </section>
      <section id="beginner-friendly">
        <div class="text-center">
          <div class="panel mx-auto max-w-prose">
            <p class="font-bold text-4xl">
              We're beginner-friendly
            </p>
            <p class="m-0">
              We believe cybersecurity should be accessible to all, so we teach everything from the ground up. Our 
              club content is designed to be approached by <em>anyone</em>, regardless of skill, major, or experience.
            </p>
          </div>
        </div>
      </section>
      <section id="philosophy">
        <div class="text-center">
          <div class="panel mx-auto max-w-prose">
            <p class="font-bold text-4xl">
              Our teaching philosophy
            </p>
            <p class="m-0">
              We believe that the best way to learn is by doing &ndash; so we're not going to lecture you for an hour. 
              Our meetings are typically 15 minutes of presentation followed by 45 minutes of hands-on hacking.
            </p>
            <Picture
              class="mx-auto rounded-xl pointer-events-none w-1/2 sm:w-1/3"
              src={pie_chart}
              alt="A pie chart showing the 15/45 meeting time breakdown."
            />
          </div>
        </div>
      </section>

      <section id="who-we-are">
        <div class="text-center pb-8">
          <div class="panel mx-auto max-w-prose">
            <p class="font-bold text-4xl">Who are we?</p>
            <p class="m-0">
              SIGPwny is completely student-run and would not be able to support everyone without the contributions 
              from our admin team, helpers, and alumni.
            </p>
          </div>
        </div>
        <section id="admins" class="pb-8">
          <h1>Admin Team</h1>
          <div class="grid xl:grid-cols-3 md:grid-cols-2 gap-4">
            {admins.map((profile) => (
              <ProfileCard profile={profile} showFull={true} />
            ))}
          </div>
        </section>
        <section id="helpers" class="pb-8">
          <h1>Helper Team</h1>
          <div class="grid xl:grid-cols-3 md:grid-cols-2 gap-4">
            {helpers.map((profile) => (
              <ProfileCard profile={profile} showFull={true} />
            ))}
          </div>
        </section>
        <section id="alumni" class="pb-8">
          <h1>Alumni</h1>
          <div class="grid xl:grid-cols-3 md:grid-cols-2 gap-4">
            {alumni.map((profile) => (
              <ProfileCard profile={profile} showFull={true} />
            ))}
          </div>
        </section>
      </section>
    </div>
  </div>
</Layout>
